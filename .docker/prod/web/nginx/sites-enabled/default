server {
        listen 80 default_server;
        listen [::]:80 default_server;
        server_name inkarnate.com www.inkarnate.com;
        return 301 https://$server_name$request_uri;
}

server {
        root /app/public;
        server_name inkarnate.com www.inkarnate.com;
        passenger_enabled on;

        # Maintenance Page

        error_page 503 @503;

        # Return a 503 error if the maintenance page exists.
        if (-f /app/public/maintenance.html) {
                return 503;
        }

        location @503 {
                # Serve static assets if found.
                if (-f $request_filename) {
                        break;
                }

                rewrite ^(.*)$ /maintenance.html break;
        }
   
        location ~ /.well-known {
                allow all;
        }
}
